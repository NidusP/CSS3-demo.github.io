<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
	<meta name="author" content="https://github.com/NidusP"/>
	<meta name="description" content="个人遇到过的一些CSS实现动画"/>
	<meta name="keywords" content="CSS3, animation"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>加载动画</title>
	<link rel="stylesheet" href="./css/css1.css">
	<link rel="stylesheet" href="./css/css2.css">
	<link rel="stylesheet" href="./css/shapes.css">
</head>
<body>
	<div class="wrapper">
		<div class="square"></div>
		<div class="rectangle"></div>
		<div class="circle"></div>
		<div class="oval"></div>
		<div class="cone"></div>
		<div class="cross"></div>
		<div class="moon"></div>
		<div class="facebook-icon"></div>
		<div class="magnifying-glass"></div>
		<div class="chevron"></div>
		<div class="tv"></div>
		<div class="triangle-up"></div>
		<div class="triangle-down"></div>
		<div class="triangle-left"></div>
		<div class="triangle-right"></div>
		<div class="triangle-topright"></div>
		<div class="triangle-topleft"></div>
		<div class="triangle-bottomright"></div>
		<div class="triangle-bottomleft"></div>
		<div class="base"></div>
		<div class="flag"></div>
		<div class="curvedarrow"></div>
		<div class="trapezoid"></div>
		<div class="parallelogram"></div>
		<div class="star-six"></div>
		<div class="star-five"></div>
		<div class="pentagon"></div>
		<div class="hexagon"></div>
		<div class="octagon"></div>
		<div class="heart"></div>
		<div class="infinity"></div>
		<div class="diamond"></div>
		<div class="diamond-shield"></div>
		<div class="diamond-narrow"></div>
		<div class="cut-diamond"></div>
		<div class="egg"></div>
		<div class="pacman"></div>
		<div class="talkbubble"></div>
		<div class="rss"></div>
		<div class="burst-12"></div>
		<div class="burst-8"></div>
		<div class="badge-ribbon"></div>
		<div class="space-invader"></div>
		<div class="pointer"></div>
		<div class="lock"></div>
		<div class="yin-yang"></div>

	</div>


	<div class="card">
		<div class="page"></div>
		<div class="page"></div>
		<div class="page"></div>
		<div class="page"></div>
		<div class="page"></div>
	</div>
	<div class="margin"></div>
	<div class="container">
		<div class="top">
			<div class="top-over">
				<div class="top-circle"></div>
			</div>
		</div>
		<div class="bottom">
			<div class="bottom-over">
				<div class="bottom-circle"></div>
			</div>
			<div class="bottom-shade"></div>
		</div>
		<span id="progress"></span>
		<span class="loading">资源加载中...</span>
	</div>
	<div class="margin"></div>
	<div class="book">
		<div class="item">
			<span class="line"></span>
			<span class="line"></span>
			<span class="line"></span>
		</div>
		<div class="item">
			<span class="line"></span>
			<span class="line"></span>
			<span class="line"></span>
		</div>
	</div>
</body>
<script>
	const card = document.querySelector('.card')
	const book = document.querySelector('.book')
	const topCover = document.querySelector('.top-over')
	const bottomShade = document.querySelector('.bottom-shade')
	const progress = document.querySelector('#progress')
	const loading = document.querySelector('.loading')

	let deg = 0
	function running(){
		deg = deg >= 100 ? 0 : deg+1;
		progress.innerHTML = deg+"%"
		rotate(deg)
	}
	function rotate(deg){
		if(deg<=50){
			topCover.style.transform = "rotate("+ (180-3.6*deg) +"deg)";
			bottomShade.style.transform = "rotate(0deg)";
		}else{
			topCover.style.transform = "rotate(0deg)";
			bottomShade.style.transform = "rotate("+ (3.6*(50-deg)) +"deg)";
		}
		loading.style.filter = `opacity(${deg}%)`
	}
	setInterval(function(){
		running();
	}, 50)
	// document.addEventListener('DOMContentLoaded',function(){
	// 	console.log('3 seconds passed');
	// });




	let p1 = new Promise((resolve, reject) => {
		window.addEventListener('load', function () {
			resolve('资源加载完毕')
		})
	})

	let p2 = new Promise((resolve, reject) => {
		setTimeout(resolve, 5000, 'p2: 5s passed')
	})
	Promise.all([p1, p2]).then(function (results) {
		card.style.opacity = '1'
		book.style.opacity = '1'
		loading.innerHTML = '资源加载完成...'
		setTimeout(() => {
			loading.style.display = 'none'
		}, 20)
		console.log(results); // 获得一个Array: ['P1', 'P2']
	});
</script>
</html>
