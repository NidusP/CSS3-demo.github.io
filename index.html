<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
	<meta name="author" content="https://github.com/NidusP"/>
	<meta name="description" content="个人遇到过的一些CSS实现动画"/>
	<meta name="keywords" content="CSS3, animation"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title>加载动画</title>
	<link rel="stylesheet" href="./css/css1.css">
	<link rel="stylesheet" href="./css/css2.css">
</head>
<body>
	<div class="card">
		<div class="page"></div>
		<div class="page"></div>
		<div class="page"></div>
		<div class="page"></div>
		<div class="page"></div>
	</div>
	<div class="margin"></div>
	<div class="container loading">
		<div class="top">
			<div class="top-over">
				<div class="top-circle"></div>
			</div>
		</div>
		<div class="bottom">
			<div class="bottom-over">
				<div class="bottom-circle"></div>
			</div>
			<div class="bottom-shade"></div>
		</div>
		<span id="progress"></span>
	</div>
	<div class="margin"></div>
	<div class="book">
		<div class="item">
			<span class="line"></span>
			<span class="line"></span>
			<span class="line"></span>
		</div>
		<div class="item">
			<span class="line"></span>
			<span class="line"></span>
			<span class="line"></span>
		</div>
	</div>
</body>
<script>
	const card = document.querySelector('.card')
	const book = document.querySelector('.book')
	const topCover = document.querySelector('.top-over')
	const bottomShade = document.querySelector('.bottom-shade')
	const progress = document.querySelector('#progress')

	let deg = 0
	function running(){
		deg = deg >= 100 ? 0 : deg+1;
		progress.innerHTML = deg+"%"
		rotate(deg)
	}
	function rotate(deg){
		if(deg<=50){
			topCover.style.transform = "rotate("+ (180-3.6*deg) +"deg)";
			bottomShade.style.transform = "rotate(0deg)";
		}else{
			topCover.style.transform = "rotate(0deg)";
			bottomShade.style.transform = "rotate("+ (3.6*(50-deg)) +"deg)";
		}
	}
	setInterval(function(){
		running();
	}, 50)
	// document.addEventListener('DOMContentLoaded',function(){
	// 	console.log('3 seconds passed');
	// });

	let p1 = new Promise((resolve, reject) => {
		window.addEventListener('load', function () {
			resolve('资源加载完毕')
		})
	})

	let p2 = new Promise((resolve, reject) => {
		setTimeout(resolve, 5000, 'p2: 5s passed')
	})
	Promise.all([p1, p2]).then(function (results) {
		card.style.opacity = '1'
		book.style.opacity = '1'
		console.log(results); // 获得一个Array: ['P1', 'P2']
	});
</script>
</html>
